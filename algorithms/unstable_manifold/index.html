<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Stable and Unstable Manifold · GAIO.jl</title><meta name="title" content="Stable and Unstable Manifold · GAIO.jl"/><meta property="og:title" content="Stable and Unstable Manifold · GAIO.jl"/><meta property="twitter:title" content="Stable and Unstable Manifold · GAIO.jl"/><meta name="description" content="Documentation for GAIO.jl."/><meta property="og:description" content="Documentation for GAIO.jl."/><meta property="twitter:description" content="Documentation for GAIO.jl."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/citations.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="GAIO.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">GAIO.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><a class="tocitem" href="../../getting_started/">Getting started</a></li><li><a class="tocitem" href="../../general/">General usage</a></li><li><span class="tocitem">Invariant Sets</span><ul><li><a class="tocitem" href="../limit_sets/">Limit Sets and Attractors</a></li><li><a class="tocitem" href="../recurrent_set/">Reccurent Set</a></li><li class="is-active"><a class="tocitem" href>Stable and Unstable Manifold</a></li></ul></li><li><span class="tocitem">Transfer- and Koopman Operators</span><ul><li><a class="tocitem" href="../transfer_operator/">Ulam&#39;s method and Invariant Measures</a></li><li><a class="tocitem" href="../almost_invariant/">Almost Invariant (metastable) Sets</a></li><li><a class="tocitem" href="../cyclic/">Cyclic Sets</a></li><li><a class="tocitem" href="../coherent/">Coherent Sets</a></li><li><a class="tocitem" href="../seba/">Extracting Multiple Sets via SEBA</a></li></ul></li><li><span class="tocitem">Scalar Diagnostics</span><ul><li><a class="tocitem" href="../box_dimension/">Fractal Dimension</a></li><li><a class="tocitem" href="../ftle/">Lyapunov Exponents / FTLEs</a></li></ul></li><li><span class="tocitem">Conley-Morse Theory</span><ul><li><a class="tocitem" href="../morse_graph/">Morse Graph</a></li><li><a class="tocitem" href="../conley_index/">Conley Index</a></li></ul></li><li><span class="tocitem">Misceallenous Algorithms</span><ul><li><a class="tocitem" href="../root_covering/">Root Covering</a></li><li><a class="tocitem" href="../implicit_manifold/">Covering Implicitly Defined Manifolds</a></li></ul></li><li><a class="tocitem" href="../../plotting/">Plotting</a></li><li><span class="tocitem">Maximizing Performance</span><ul><li><a class="tocitem" href="../../cuda/">Using the GPU (Nvidia)</a></li><li><a class="tocitem" href="../../metal/">Using the GPU (Metal)</a></li></ul></li><li><a class="tocitem" href="../../examples/">Other Examples</a></li><li><span class="tocitem">BoxMaps</span><ul><li><a class="tocitem" href="../../boxmaps/boxmaps_general/">An Overview of BoxMap Types</a></li><li><a class="tocitem" href="../../boxmaps/montecarlo/"><code>MonteCarloBoxMap</code></a></li><li><a class="tocitem" href="../../boxmaps/grid/"><code>GridBoxMap</code></a></li><li><a class="tocitem" href="../../boxmaps/adaptive/"><code>AdaptiveBoxMap</code></a></li><li><a class="tocitem" href="../../boxmaps/interval/"><code>IntervalBoxMap</code></a></li><li><a class="tocitem" href="../../boxmaps/boxmaps_cuda/"><code>GPUSampledBoxmap</code></a></li><li><a class="tocitem" href="../../boxmaps/pointdiscretized/"><code>PointDiscretizedBoxMap</code></a></li><li><a class="tocitem" href="../../boxmaps/sampled/"><code>SampledBoxMap</code></a></li><li><a class="tocitem" href="../../boxmaps/new_types/">Creating you own BoxMap type</a></li></ul></li><li><a class="tocitem" href="../../library_reference/">Library Reference</a></li><li><a class="tocitem" href="../../references/">References</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Invariant Sets</a></li><li class="is-active"><a href>Stable and Unstable Manifold</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Stable and Unstable Manifold</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/gaioguys/GAIO.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/gaioguys/GAIO.jl/blob/master/docs/src/algorithms/unstable_manifold.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Unstable-Set"><a class="docs-heading-anchor" href="#Unstable-Set">Unstable Set</a><a id="Unstable-Set-1"></a><a class="docs-heading-anchor-permalink" href="#Unstable-Set" title="Permalink"></a></h1><p>In the following we are presenting the algorithm to cover invariant manifolds within some domain <span>$Q$</span>, which has to contain a fixed point.</p><div class="admonition is-info" id="Note-d030718834897cb"><header class="admonition-header">Note<a class="admonition-anchor" href="#Note-d030718834897cb" title="Permalink"></a></header><div class="admonition-body"><p>For simplicity, we will explain the algorithm for the case of the <em>unstable manifold</em>. However one can compute the stable manifold as well by considering the boxmap describing the inverse map <span>$f^{-1}$</span> as input argument for the algorithm.</p></div></div><h3 id="Mathematical-Background"><a class="docs-heading-anchor" href="#Mathematical-Background">Mathematical Background</a><a id="Mathematical-Background-1"></a><a class="docs-heading-anchor-permalink" href="#Mathematical-Background" title="Permalink"></a></h3><p>The unstable manifold is defined as</p><p class="math-container">\[W^U(x_0) = \{x: \lim_{k \to - \infty} f^k(x) = x_0 \}\]</p><p>where <span>$x_0$</span> is a fixed point of <span>$f$</span>.</p><p>The idea behind the algorithm [<a href="../../references/#subalg">4</a>] to compute the unstable manifold can be explained in two steps. Before starting we need to identify a hyperbolic fixed point and the region <span>$Q$</span>, which we are going to compute the manifold in. The region <span>$Q$</span> needs to be already partitioned into small boxes.</p><ol><li><strong>initialization step</strong> Since a fixed point is always part of the unstable manifold, we need to identify a small region/box containing this fixed point. This box may be known a-priori, or one can use the <code>relative_attractor</code> around a small region where one suspects a fixed point to exist. </li><li><strong>continuation step</strong> The small box containing the fixed point is then mapped forward by <code>F</code> and the boxes that are hit under the image are added to the box collection. Then those newly included boxes are mapped forward and the procedure is repeated until no new boxes are added. </li></ol><div class="admonition is-warning" id="Note-on-Convergence-6d458c7250ff5ab5"><header class="admonition-header">Note on Convergence<a class="admonition-anchor" href="#Note-on-Convergence-6d458c7250ff5ab5" title="Permalink"></a></header><div class="admonition-body"><p>One might not be able to compute the parts of the unstable manifold whose preimage lies outside the domain <span>$Q$</span>. Thus, it is important to choose <span>$Q$</span> large enough.</p></div></div><h3 id="Example"><a class="docs-heading-anchor" href="#Example">Example</a><a id="Example-1"></a><a class="docs-heading-anchor-permalink" href="#Example" title="Permalink"></a></h3><pre><code class="language-julia hljs">using GAIO

# the Lorenz system
const σ, ρ, β = 10.0, 28.0, 0.4
v((x,y,z)) = (σ*(y-x), ρ*x-y-x*z, x*y-β*z)

# time-0.2 flow map
f(x) = rk4_flow_map(v, x)

center, radius = (0,0,25), (30,30,30)
Q = Box(center, radius)
P = BoxGrid(Q, (256,256,256))
F = BoxMap(:adaptive, f, Q)

# equilibrium
x = (sqrt(β*(ρ-1)), sqrt(β*(ρ-1)), ρ-1)
S = cover(P, x)

W = unstable_set(F, S)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">202489 - element BoxSet in 256 x 256 x 256 - element BoxGrid</code></pre><pre><code class="language-julia hljs">using GLMakie

fig, ax, ms = plot(W);</code></pre><p><img src="../unstable_manifold.png" alt="Unstable manifold"/></p><p>We can animate this plot using the <code>record</code> function from Makie.jl</p><pre><code class="language-julia hljs">fig = Figure();
ax = Axis3(fig[1,1], viewmode=:fit)
ms = plot!(ax, W, color=(:red, 0.6))

n_frames = 120
record(fig, &quot;unstable.gif&quot;, 1:n_frames, framerate=20) do frame
    v = sin(2pi * frame / n_frames)
    ax.elevation[] = pi/8 - pi * v / 10
    ax.azimuth[] = pi * v / 2
end;</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">&quot;unstable.gif&quot;</code></pre><p><img src="../unstable.gif" alt="Unstable Manifold Gif"/></p><pre><code class="language-julia hljs">fig, ax, ms = plot(W);</code></pre><pre><code class="language-julia hljs"># integrate in reverse time:
# 5 steps of rk4 method with step size -0.01
f(x) = rk4_flow_map(v, x, -0.01, 5)

center, radius = (0,0,25), (120,180,160)
Q = Box(center, radius)
P = BoxGrid(Q, (256,256,256))
F = BoxMap(:grid, f, Q, n_points=(8,8,8))

# Equillibrium (0,0,0) lies at the bottom corner of one box.
# Cover a small neighborhood of (0,0,0) instead
x = Box( (0,0,0), 0.01 .* (1,1,1) )
S = cover(P, x)

W2 = unstable_set(F, S)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">397144 - element BoxSet in 256 x 256 x 256 - element BoxGrid</code></pre><pre><code class="language-julia hljs">fig = Figure();
ax = Axis3(fig[1,1], azimuth=0.62*pi)
ms = plot!(ax, W2)</code></pre><p><img src="../stable_manifold.png" alt="Stable manifold"/></p><pre><code class="language-julia hljs">record(fig, &quot;stable.gif&quot;, 1:n_frames, framerate=20) do frame
    v = sin(2pi * frame / n_frames)
    ax.elevation[] = pi/10 - pi * v / 20
    ax.azimuth[] = -pi / 5 + 2pi * v / 5
end;</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">&quot;stable.gif&quot;</code></pre><p><img src="../stable.gif" alt="Stable Manifold Gif"/></p><h3 id="Implementation"><a class="docs-heading-anchor" href="#Implementation">Implementation</a><a id="Implementation-1"></a><a class="docs-heading-anchor-permalink" href="#Implementation" title="Permalink"></a></h3><pre><code class="language-julia hljs">function unstable_set(F::BoxMap, B::BoxSet)
    B₀ = B
    B₁ = B
    while !isempty(B₁)
        B₁ = F(B₁)          # map the current interation forward
        setdiff!(B₁, B₀)    # remove boxes we&#39;ve already seen
        union!(B₀, B₁)      # add the new boxes to the collection
    end
    return B₀
end</code></pre><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GAIO.unstable_set-algorithms-unstable_manifold" href="#GAIO.unstable_set-algorithms-unstable_manifold"><code>GAIO.unstable_set</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">unstable_set(F::BoxMap, B::BoxSet) -&gt; BoxSet</code></pre><p>Compute the unstable set for a box set <code>B</code>. Generally, <code>B</code> should be  a small box surrounding a fixed point of <code>F</code>. The partition must  be fine enough, since no subdivision occurs in this algorithm. </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/gaioguys/GAIO.jl/blob/3f3fd29cdf1b27e2b48a09f3842ad5d7b4aaa472/src/algorithms/invariant_sets.jl#L130-L136">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../recurrent_set/">« Reccurent Set</a><a class="docs-footer-nextpage" href="../transfer_operator/">Ulam&#39;s method and Invariant Measures »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.14.1 on <span class="colophon-date" title="Tuesday 16 September 2025 07:49">Tuesday 16 September 2025</span>. Using Julia version 1.10.10.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
