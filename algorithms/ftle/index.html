<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Lyapunov Exponents / FTLEs · GAIO.jl</title><meta name="title" content="Lyapunov Exponents / FTLEs · GAIO.jl"/><meta property="og:title" content="Lyapunov Exponents / FTLEs · GAIO.jl"/><meta property="twitter:title" content="Lyapunov Exponents / FTLEs · GAIO.jl"/><meta name="description" content="Documentation for GAIO.jl."/><meta property="og:description" content="Documentation for GAIO.jl."/><meta property="twitter:description" content="Documentation for GAIO.jl."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/citations.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="GAIO.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">GAIO.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><a class="tocitem" href="../../getting_started/">Getting started</a></li><li><a class="tocitem" href="../../general/">General usage</a></li><li><span class="tocitem">BoxMaps</span><ul><li><a class="tocitem" href="../../boxmaps/boxmaps_general/">An Overview of BoxMap Types</a></li><li><a class="tocitem" href="../../boxmaps/montecarlo/"><code>MonteCarloBoxMap</code></a></li><li><a class="tocitem" href="../../boxmaps/grid/"><code>GridBoxMap</code></a></li><li><a class="tocitem" href="../../boxmaps/adaptive/"><code>AdaptiveBoxMap</code></a></li><li><a class="tocitem" href="../../boxmaps/interval/"><code>IntervalBoxMap</code></a></li><li><a class="tocitem" href="../../boxmaps/boxmaps_simd/"><code>CPUSampledBoxMap</code></a></li><li><a class="tocitem" href="../../boxmaps/boxmaps_cuda/"><code>GPUSampledBoxmap</code></a></li><li><a class="tocitem" href="../../boxmaps/pointdiscretized/"><code>PointDiscretizedBoxMap</code></a></li><li><a class="tocitem" href="../../boxmaps/sampled/"><code>SampledBoxMap</code></a></li><li><a class="tocitem" href="../../boxmaps/new_types/">Creating you own BoxMap type</a></li></ul></li><li><span class="tocitem">Invariant Sets</span><ul><li><a class="tocitem" href="../relative_attractor/">Relative Attractor</a></li><li><a class="tocitem" href="../chain_recurrent_set/">Chain Reccurent Set</a></li><li><a class="tocitem" href="../maximal_invariant_set/">Maximal Invariant Set</a></li><li><a class="tocitem" href="../unstable_manifold/">Stable and Unstable Manifold</a></li></ul></li><li><span class="tocitem">Transfer- and Koopman Operators</span><ul><li><a class="tocitem" href="../transfer_operator/">Ulam&#39;s method and Invariant Measures</a></li><li><a class="tocitem" href="../almost_invariant/">Almost Invariant (metastable) Sets</a></li><li><a class="tocitem" href="../cyclic/">Cyclic Sets</a></li><li><a class="tocitem" href="../coherent/">Coherent Sets</a></li><li><a class="tocitem" href="../seba/">Extracting Multiple Sets via SEBA</a></li></ul></li><li><span class="tocitem">Scalar Diagnostics</span><ul><li><a class="tocitem" href="../box_dimension/">Fractal Dimension</a></li><li class="is-active"><a class="tocitem" href>Lyapunov Exponents / FTLEs</a></li></ul></li><li><span class="tocitem">Conley-Morse Theory</span><ul><li><a class="tocitem" href="../morse_graph/">Morse Graph</a></li><li><a class="tocitem" href="../conley_index/">Conley Index</a></li></ul></li><li><span class="tocitem">Misceallenous Algorithms</span><ul><li><a class="tocitem" href="../root_covering/">Root Covering</a></li><li><a class="tocitem" href="../implicit_manifold/">Covering Implicitly Defined Manifolds</a></li></ul></li><li><a class="tocitem" href="../../plotting/">Plotting</a></li><li><span class="tocitem">Maximizing Performance</span><ul><li><a class="tocitem" href="../../simd/">Using the CPU</a></li><li><a class="tocitem" href="../../cuda/">Using the GPU (Nvidia)</a></li><li><a class="tocitem" href="../../metal/">Using the GPU (Metal)</a></li></ul></li><li><a class="tocitem" href="../../examples/">Other Examples</a></li><li><a class="tocitem" href="../../data_structures/">Data Structures</a></li><li><a class="tocitem" href="../../library_reference/">Library Reference</a></li><li><a class="tocitem" href="../../references/">References</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Scalar Diagnostics</a></li><li class="is-active"><a href>Lyapunov Exponents / FTLEs</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Lyapunov Exponents / FTLEs</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/gaioguys/GAIO.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/gaioguys/GAIO.jl/blob/master/docs/src/algorithms/ftle.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Finite-Time-Lyapunov-Exponents"><a class="docs-heading-anchor" href="#Finite-Time-Lyapunov-Exponents">Finite Time Lyapunov Exponents</a><a id="Finite-Time-Lyapunov-Exponents-1"></a><a class="docs-heading-anchor-permalink" href="#Finite-Time-Lyapunov-Exponents" title="Permalink"></a></h1><h3 id="Mathematical-Background"><a class="docs-heading-anchor" href="#Mathematical-Background">Mathematical Background</a><a id="Mathematical-Background-1"></a><a class="docs-heading-anchor-permalink" href="#Mathematical-Background" title="Permalink"></a></h3><p>We change focus now to a continuous dynamical system, e.g. an ODE <span>$\dot{u} = g(t, u)$</span> with solution <span>$\Phi^{t,t_0} (x)$</span>. Since <span>$\Phi^{t,t_0} (x)$</span> is continuously dependent on the initial condition <span>$x$</span>, there exists an <span>$\tilde{x}$</span> near <span>$x$</span> with <span>$sup_{t \in [t_0 , t_0 + T]} \| \Phi^{t,t_0} (\tilde{x}) - \Phi^{t,t_0} (x) \| &lt; \epsilon$</span> for any fixed <span>$\epsilon &gt; 0$</span> and <span>$T$</span> small enough. We wish to characterize this expansion term. We write <span>$\Phi = \Phi^{t_0+T,t_0}$</span> and <span>$y = x + \delta x_0$</span> where <span>$\delta x_0 \in \mathbb{R}^d$</span> is infinitesimal. Then if <span>$g$</span> is <span>$\mathcal{C}^1$</span> w.r.t. <span>$x$</span>,</p><p class="math-container">\[\delta x (t_0 + T) := \Phi (y) - \Phi (x)
= D_x \Phi (x) \cdot \delta x_0 + \mathcal{O}(\| \delta x_0 \|^2)\]</p><p>Hence we can write </p><p class="math-container">\[\| \delta x (t_0 + T) \|_2 = \| D_x \Phi (x) \cdot \delta x_0 \|_2 \leq \| D_x \Phi (x) \|_2 \cdot \| \delta x_0 \|_2\]</p><p>or equivalently</p><p class="math-container">\[\frac{ \| \delta x (t_0 + T) \|_2 }{ \| \delta x_0 \|_2 } \leq \| D_x \Phi (x) \|_2\]</p><p>where equality holds if <span>$\delta x_0$</span> is the eigenvector corresponding to the largest eigenvalue of </p><p class="math-container">\[\Delta = \left( D_x \Phi (x) \right)^T \left( D_x \Phi (x) \right) . \]</p><p>Hence if we define </p><p class="math-container">\[\sigma (x) = \sigma^{t_0 + T, t_0} (x) := \frac{1}{T} \ln \left( \sqrt{\lambda_{\text{max}}} (\Delta) \right) = \frac{1}{T} \ln \left( \sup_{\delta x_0} \frac{ \| \delta x (t_0 + T) \|_2 }{ \| \delta x_0 \|_2 } \right)\]</p><p>then </p><p class="math-container">\[\| \delta x (t_0 + T) \|_2 \leq e^{T \cdot \sigma (x)} \cdot \| \delta x_0 \|_2 . \]</p><p>From this we see why <span>$\sigma (x)$</span> is called the <em>maximal finite-time lyapunov exponent (FTLE)</em>. </p><p>The definition of <span>$\sigma (x)$</span> leads to a natural <em>ansatz</em> for approximating the FTLE: compute <span>$\frac{1}{T} \ln \left( \sup_{\delta x_0} \frac{ \| \delta x (t_0 + T) \|_2 }{ \| \delta x_0 \|_2 } \right)$</span> for each of a set of test points <span>$\| \delta x_0 \|$</span> of fixed order <span>$\epsilon &gt; 0$</span> and set <span>$\sigma (x)$</span> to be the maximum over this set of test points. </p><p>An extension of this technique can be made for <em>ergodic</em> systems, as shown in [<a href="../../references/#beyn">15</a>]: </p><p>when calculating the maximal Lyapunov exponent for a discrete dynamical system <span>$x_{n+1} = f(x_k)$</span> defined as </p><p class="math-container">\[\lambda (x, v) = \lim_{n \to \infty} \frac{1}{n} \log \| Df^n (x) \cdot v \|\]</p><p>a known technique is to use a QR iteration. Let <span>$A = Q(A) R(A)$</span> be the unique QR-decomposition of a nonsingular matrix <span>$A$</span> into an orthogonal matrix <span>$Q(A)$</span> and an upper-triangular matrix <span>$R(A)$</span>. Then from <span>$\| Av \| = \| R(A) v \|$</span> we have </p><p class="math-container">\[\lim_{n \to \infty} \frac{1}{n} \log \| Df^n(x) v \| = \lim_{n \to \infty} \frac{1}{n} \log \| R(Df^n(x))v \|. \]</p><p>Further, the Lyapunov exponents of the system <span>$\lambda_1, \ldots, \lambda_d$</span> (which are costant over the phase space for an ergodic system) can be found via</p><p class="math-container">\[\lambda_j = \lim_{n \to \infty} \frac{1}{n} \log R_{jj}(Df^n(x))\]</p><p>the <span>$j$</span>-th diagonal element of <span>$R$</span>, for <span>$j = 1, \ldots, d$</span>. </p><p>Using an extension of the Birkhoff ergodic theorem it can be proven that this method is equivalent to computing</p><p class="math-container">\[\lambda_j = \lim_{n \to \infty} \int \log R_{jj}(Df^n(x)) \, d\mu\]</p><p>where <span>$\mu$</span> is a measure which is ergodic and invariant under <span>$f$</span>. </p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GAIO.finite_time_lyapunov_exponents-algorithms-ftle" href="#GAIO.finite_time_lyapunov_exponents-algorithms-ftle"><code>GAIO.finite_time_lyapunov_exponents</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">finite_time_lyapunov_exponents(F::SampledBoxMap, boxset::BoxSet) -&gt; BoxMeasure</code></pre><p>Compute the Finite Time Lyapunov Exponent for  every box in <code>boxset</code>, where <code>F</code> represents a time-<code>T</code>  integration of some continuous dynamical system.  It is assumed that all boxes in <code>boxset</code> have radii  of some fixed order ϵ. </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/gaioguys/GAIO.jl/blob/ded2bd3599320a56670480ebf0d692f30dd6dcbf/src/algorithms/scalar_diagnostics.jl#L1-L9">source</a></section><section><div><pre><code class="language-julia hljs">finite_time_lyapunov_exponents(f, Df, μ::BoxMeasure; n=8) -&gt; σ</code></pre><p>Compute the Lyapunov exponents using a spatial integration  method [1] based on Birkhoff&#39;s ergodic theorem. Computes </p><p class="math-container">\[\sigma_j = \frac{1}{n} \int \log R_{jj}( Df^n (x) ) \, dμ (x), \quad j = 1, \ldots, d\]</p><p>with respect to an ergodic invariant measure <span>$\mu$</span>. </p><p>[1] Beyn, WJ., Lust, A. A hybrid method for computing  Lyapunov exponents. Numer. Math. 113, 357–375 (2009).  https://doi.org/10.1007/s00211-009-0236-4</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/gaioguys/GAIO.jl/blob/ded2bd3599320a56670480ebf0d692f30dd6dcbf/src/algorithms/scalar_diagnostics.jl#L78-L91">source</a></section></article><h3 id="Example"><a class="docs-heading-anchor" href="#Example">Example</a><a id="Example-1"></a><a class="docs-heading-anchor-permalink" href="#Example" title="Permalink"></a></h3><p>We will continue using the periodically driven double-gyre introduced in the section on <a href="../almost_invariant/#Almost-Invariant-(metastable)-Sets">Almost Invariant (metastable) Sets</a>. See that code block for the definition of the map. </p><pre><code class="language-julia hljs">t₀, τ, steps = 0, 0.1, 20
t₁ = t₀ + τ * steps
Tspan = t₁ - t₀
Φₜ₀ᵗ¹(z) = Φ(z, t₀, τ, steps)

domain = Box((1.0, 0.5), (1.0, 0.5))
P = BoxPartition(domain, (256, 128))
S = cover(P, :)

F = BoxMap(:grid, Φₜ₀ᵗ¹, domain, n_points=(6,6))

γ = finite_time_lyapunov_exponents(F, S; T=Tspan)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">BoxMeasure in 256 x 128 - element BoxPartition with 32768 boxes in its suport</code></pre><pre><code class="language-julia hljs">using Plots

p = plot(γ, clims=(0,2), colormap=:jet);</code></pre><p><img src="../ftle1.svg" alt="FTLE field at time 0"/></p><p>Since this map is time-dependent, the FTLE field will change over time as well. </p><pre><code class="language-julia hljs">n_frames = 120
times = range(t₀, t₁, length=n_frames)

anim = @animate for t in times
    Φₜ(z) = Φ(z, t, τ, steps)

    F = BoxMap(:grid, Φₜ, domain, n_points=(6,6))
    γ = finite_time_lyapunov_exponents(F, S; T=Tspan)

    plot(γ, clims=(0,2), colormap=:jet)
end;
gif(anim, &quot;ftle1.gif&quot;, fps=20)</code></pre><p><img src="../../assets/ftle1.gif" alt="FTLE field"/></p><h3 id="Example-2:-An-Ergodic-System"><a class="docs-heading-anchor" href="#Example-2:-An-Ergodic-System">Example 2: An Ergodic System</a><a id="Example-2:-An-Ergodic-System-1"></a><a class="docs-heading-anchor-permalink" href="#Example-2:-An-Ergodic-System" title="Permalink"></a></h3><pre><code class="language-julia hljs">using GAIO
using Plots
using StaticArrays

# the Henon map
a, b = 1.4, 0.3
f((x,y)) = SA{Float64}[ 1 - a*x^2 + y, b*x ]
Df((x,y)) = SA{Float64}[-2*a*x    1.;
                         b        0.]

center, radius = (0, 0), (3, 3)
P = BoxPartition(Box(center, radius))
F = BoxMap(f, P)
S = cover(P, :)
A = relative_attractor(F, S, steps = 20)

T = TransferOperator(F, A, A)
(λ, ev) = eigs(T)
μ = real ∘ ev[1]

σ16 = finite_time_lyapunov_exponents(f, Df, μ, n=16)
σ8  = finite_time_lyapunov_exponents(f, Df, μ, n=8)

σ = 2*σ16 - σ8</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../box_dimension/">« Fractal Dimension</a><a class="docs-footer-nextpage" href="../morse_graph/">Morse Graph »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.7.0 on <span class="colophon-date" title="Sunday 20 October 2024 11:44">Sunday 20 October 2024</span>. Using Julia version 1.10.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
